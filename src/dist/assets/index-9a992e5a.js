(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&u(a)}).observe(document,{childList:!0,subtree:!0});function g(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(e){if(e.ep)return;e.ep=!0;const o=g(e);fetch(e.href,o)}})();document.addEventListener("DOMContentLoaded",()=>{const d=document.querySelector(".login-form"),i=document.querySelector(".register-form"),g=document.getElementById("showLogin"),u=document.getElementById("showRegister"),e=document.getElementById("registerForm"),o=document.getElementById("loginForm"),a=document.getElementById("loginEmail"),f=document.getElementById("loginPassword"),E=document.getElementById("registerEmail"),h=document.getElementById("registerPassword"),t=document.getElementById("registerErrorText"),s=document.getElementById("loginErrorText"),n=document.getElementById("registerSuccessText");g.addEventListener("click",c=>{c.preventDefault(),d.style.display="block",i.style.display="none",t.style.display="none",n.style.display="none"}),u.addEventListener("click",c=>{c.preventDefault(),d.style.display="none",i.style.display="block",t.style.display="none",n.style.display="none"}),e.addEventListener("submit",async c=>{c.preventDefault();const y=E.value,m=h.value;if(y&&m)try{const r=await fetch("http://localhost:3000/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:y,password:m})});if(r.ok){const l=await r.json();if(l.status==="success"){n.textContent="Регистрация прошла успешно!",n.style.color="green",n.style.display="block",t.style.display="none",d.style.display="block",i.style.display="none";const p=document.createElement("p");p.textContent="Вы успешно зарегистрированы. Можете войти!",p.style.color="green",d.insertBefore(p,o)}else t.textContent=l.message||"Произошла ошибка при регистрации.",t.style.color="red",t.style.display="block",n.style.display="none"}else{const l=await r.json();t.textContent=l.message||"Произошла ошибка при регистрации. Попробуйте снова.",t.style.color="red",t.style.display="block",n.style.display="none"}}catch{t.textContent="Произошла ошибка при регистрации. Попробуйте снова.",t.style.color="red",t.style.display="block",n.style.display="none"}else t.textContent="Пожалуйста, заполните все поля.",t.style.color="red",t.style.display="block",n.style.display="none"}),o.addEventListener("submit",async c=>{c.preventDefault();const y=a.value,m=f.value;if(y&&m)try{const r=await fetch("http://localhost:3000/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:y,password:m})});if(r.ok){const l=await r.json();l.status==="success"?window.location.href="design-editor.html":(s.textContent=l.message||"Произошла ошибка при входе.",s.style.color="red",s.style.display="block")}else{const l=await r.json();s.textContent=l.message||"Произошла ошибка при входе. Попробуйте снова.",s.style.color="red",s.style.display="block"}}catch{s.textContent="Произошла ошибка при входе. Попробуйте снова.",s.style.color="red",s.style.display="block"}else s.textContent="Пожалуйста, заполните все поля.",s.style.color="red",s.style.display="block"})});
